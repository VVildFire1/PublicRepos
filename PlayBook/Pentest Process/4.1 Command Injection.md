#### Web Application Exploits

- **Command Line Injection**:
  - **Overview**: Command line injection is a vulnerability where an attacker can execute arbitrary commands on the host operating system via a vulnerable application. It typically occurs when a web application passes unsafe user-supplied data (forms, cookies, HTTP headers, etc.) to system shells.
  - **Detection Techniques**: Detection involves testing input fields and other data submission points for improper input validation. Tools like Burp Suite or manual testing using special characters that can trigger command line execution are commonly used.
  - **Exploitation Methods**: Exploitation is achieved by inserting or injecting commands into the input fields. This may involve crafting payloads that the application executes on the server's operating system. Tools like Metasploit can be used to automate this process.
  - **Preventive Measures**: Prevention includes proper input validation, use of parameterized queries, and limiting web application privileges on the server. Regularly updating and patching software also reduces the risk.
---

<img src="PlayBook/Images/WebappInjection.png">

![](WebappInjection.png)

---
#### Analyzing a Web Application

- **Initial Discovery with dirb**:
  - The web application was discovered using `dirb`. See [website scanning](3.1%20Website%20scanning.md) for more details on the scanning process.

- **Exploratory options**:
  1. [***Using Burp Suite***:](Burp%20Suite.md)
   - Start by using Burp Suite to understand the web application's behavior and interactions.
  2. **Viewing Page Source**:
   - Inspect the source code of the web application to look for clues or hidden functionalities.
  3. **Interacting with the Application**:
   - Begin testing the application by interacting with it. For instance, entering `admin` for both username and password fields.

- **Observations and Tests**:
  - Initially, using a generic credential like `admin` for both fields granted access, suggesting a security flaw.
  - Further tests with random credentials also succeeded, indicating the application may be improperly handling authentication.
  - A test with only a file name and no credentials still granted access, pointing towards a poorly implemented or broken application.

- **Testing for Command Injection**:
  - Attempted to input simple Linux commands to test for command injection vulnerabilities.

  - **First Attempt with `id` Command**:
   ```shell
   id
   ```
   - No observable response, indicating the command was not executed.

  - **Using Semicolon for Command Separation**:
   - In Linux, the semicolon `;` is a command separator, allowing sequential execution of multiple commands.
   - Example format:
   
  ```bash
  command1 ; command2 ; command3
    ```

   - `command1` is executed first, followed by `command2` and `command3`, irrespective of their individual success or failure.

  - **Second Attempt with Semicolon**:
  
```shell
   ;id
```

   - This returned a user ID (uid), indicating successful command execution. This confirms the web application is vulnerable to command injection, allowing the execution of Linux commands.

- **Next Steps: Reverse Shell**:
  - With confirmed command injection, a [Reverse Shell](Reverse%20Shell%20and%20Upgrades.md) can be attempted to gain further control over the server.
